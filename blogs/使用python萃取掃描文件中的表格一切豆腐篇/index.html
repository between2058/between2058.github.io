<!DOCTYPE html>
<html>

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="icon" href=/fav.png type="image/gif">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
    href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
    rel="stylesheet">


<link rel="stylesheet" href="/css/font.css" media="all">



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-DWJJVE27WD', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<meta property="og:title" content="使用python萃取掃描文件中的表格(一)切豆腐篇" />
<meta property="og:description" content="
在這個漸漸邁向大數據的時代裡，資料將會成為最珍貴的寶物，為了要快速用程式分析這些大數據，我們不但要將未來的各種事物直接導向數位化，更要學習如何把過去的傳統紙本資料轉化為數位格式。
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://between2058.github.io/blogs/%E4%BD%BF%E7%94%A8python%E8%90%83%E5%8F%96%E6%8E%83%E6%8F%8F%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E8%A1%A8%E6%A0%BC%E4%B8%80%E5%88%87%E8%B1%86%E8%85%90%E7%AF%87/" /><meta property="article:section" content="blogs" />
<meta property="article:published_time" content="2020-02-21T23:29:21+05:30" />
<meta property="article:modified_time" content="2020-02-21T23:29:21+05:30" /><meta property="og:site_name" content="Johnny&#39;s blog" />


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="使用python萃取掃描文件中的表格(一)切豆腐篇"/>
<meta name="twitter:description" content="
在這個漸漸邁向大數據的時代裡，資料將會成為最珍貴的寶物，為了要快速用程式分析這些大數據，我們不但要將未來的各種事物直接導向數位化，更要學習如何把過去的傳統紙本資料轉化為數位格式。
"/>



<link rel="stylesheet" href="/bootstrap-5/css/bootstrap.min.css" media="all">
<link rel="stylesheet" href="/css/header.css" media="all">
<link rel="stylesheet" href="/css/footer.css" media="all">


<link rel="stylesheet" href="/css/theme.css" media="all">




<style>
    :root {
        --text-color: #343a40;
        --text-secondary-color: #6c757d;
        --background-color: #eaedf0;
        --secondary-background-color: #64ffda1a;
        --primary-color: #007bff;
        --secondary-color: #f8f9fa;

         
        --text-color-dark: #e4e6eb;
        --text-secondary-color-dark: #b0b3b8;
        --background-color-dark: #18191a;
        --secondary-background-color-dark: #212529;
        --primary-color-dark: #ffffff;
        --secondary-color-dark: #212529;
    }
    body {
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        text-align: left;
    }
</style>

<meta name="description" content="">
<link rel="stylesheet" href="/css/single.css">


<script defer src="/fontawesome-5/all-5.15.4.js"></script>

  <title>
使用python萃取掃描文件中的表格(一)切豆腐篇 | Johnny&#39;s blog

  </title>
</head>

<body class="light" onload="loading()">
  
  
  <script src="/bootstrap-5/js/bootstrap.bundle.js"></script>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>



<header>
    <nav class="pt-3 navbar navbar-expand-lg">
        <div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5">
            
            <a class="navbar-brand primary-font text-wrap" href="/">
                
                <img src="/fav.png" width="30" height="30"
                    class="d-inline-block align-top">
                Johnny&#39;s blog
                
            </a>

            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
                aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true">
                    <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"></path>
                </svg>
            </button>

            
            <div class="collapse navbar-collapse text-wrap primary-font" id="navbarContent">
                <ul class="navbar-nav ms-auto text-center">
                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#about" aria-label="about">About</a>
                    </li>
                    

                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#education"
                            aria-label="education">Education</a>
                    </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#projects"
                            aria-label="projects">Projects</a>
                    </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#achievements"
                            aria-label="achievements">Achievements</a>
                    </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#contact"
                            aria-label="contact">Contact</a>
                    </li>
                    

                    
                    
                    
                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/blogs" title="Blog posts">
                            
                            Blog
                        </a>
                    </li>
                    
                    
                </ul>

                
                
                <div class="text-center">
                    <button id="theme-toggle">
                        <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </button>
                </div>
            
                
            </div>
        </div>
    </nav>
</header>
<div id="content">
<section id="single">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-sm-12 col-md-12 col-lg-9">
        <div class="pr-lg-4">
          <div class="title mb-5">
            <h1 class="text-center mb-4">使用python萃取掃描文件中的表格(一)切豆腐篇</h1>
            <div class="text-center">
              Johnny Chang 
              <small>|</small>
              Feb 21, 2020
            </div>
          </div>
          
          <div class="featured-image">
            <img class="img-fluid" src="/images/projects/project1.png" alt="使用python萃取掃描文件中的表格(一)切豆腐篇">
          </div>
          
          <article class="page-content">
          <blockquote>
<p>在這個漸漸邁向大數據的時代裡，資料將會成為最珍貴的寶物，為了要快速用程式分析這些大數據，我們不但要將未來的各種事物直接導向數位化，更要學習如何把過去的傳統紙本資料轉化為數位格式。</p>
</blockquote>
<h2 id="前言">前言</h2>
<p>今天就要來介紹我自己實際遇到的例子，以及我如何實作python來處理。</p>
<p>一開始，我拿到一份銀行寄來的信用卡交易紀錄，總共有945頁，為了要做些後續的計算與統計甚至是視覺化的圖表來分析這一堆資料，但是它又不是我們所熟悉的excel檔，所以剛好利用大一所學的程式語言python，來想辦法把這些資料轉成pandas的Dataframe，變成一個不會弄丟且操作自如的資料庫。</p>
<h2 id="心路歷程">心路歷程</h2>
<p>起初，上網查到一個 pytesseract似乎可以幫我完成任務，也就是Tesseract在python上的套件，是Google目前的一個開源專案，可以辨識掃描文件的文字或數字，是一個可以減少人力資源的好工具。</p>
<p>但是，對整張表格直接做辨識似乎效果不太好，數字的部分雖然辨識率還蠻高的，文字的部分表現得就沒有這麼理想。</p>
<p>因此，我詢問了大學教授的意見，他說如果用深度學習會很快，但他認為我可以先用比較一般的方式試試看，於是他建議我使用 openCV 的 Hough Line Transform 來對表格中的框線去做偵測，得到座標之後就可以切出一小塊一小塊圖片，再去使用 pytesseract 看看會不會辨識率提高一點。</p>
<p>回到宿舍上網查了一下 openCV 官網的 Hough Line Transform 介紹，直接先拿下了範例程式碼來使用看看，再根據自己的需求做點改變 ，以下說明一下我的心路歷程 :</p>
<h3 id="hough-transform">Hough Transform</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> cv2
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 讀取圖片，檔名為自定義</span>
</span></span><span style="display:flex;"><span>img <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;Scan001.png&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 將圖片轉成灰階，以利邊緣偵測</span>
</span></span><span style="display:flex;"><span>gray <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>cvtColor(img,cv2<span style="color:#f92672">.</span>COLOR_BGR2GRAY)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 用openCV的Canny函式去做邊緣偵測</span>
</span></span><span style="display:flex;"><span>edges <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>Canny(gray,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">150</span>,apertureSize <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 用openCV的HoughLines函式找出所有構成邊緣線段的4個點座標(x1,y1,x2,y2)</span>
</span></span><span style="display:flex;"><span>minLineLength <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>maxLineGap <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>lines <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>HoughLinesP(edges,<span style="color:#ae81ff">0.01</span>,np<span style="color:#f92672">.</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">180</span>,<span style="color:#ae81ff">350</span>,minLineLength,maxLineGap,<span style="color:#ae81ff">2500</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> lines:
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  將線段的四個點座標分別assign到x1,y1,x2,y2</span>
</span></span><span style="display:flex;"><span>    x1,y1,x2,y2 <span style="color:#f92672">=</span> i[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  利用openCV的line函式，對 img 化上顏色為綠色、粗度為1pixel的線段</span>
</span></span><span style="display:flex;"><span>    cv2<span style="color:#f92672">.</span>line(img,(x1,y1),(x2,y2),(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>),<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 將結果存下來，檔名為test.png</span>
</span></span><span style="display:flex;"><span>cv2<span style="color:#f92672">.</span>imwrite(<span style="color:#e6db74">&#39;test.png&#39;</span>,img)
</span></span><span style="display:flex;"><span>cv2<span style="color:#f92672">.</span>waitKey(<span style="color:#ae81ff">0</span>)
</span></span></code></pre></div><p>輸出結果的test.png結果如下圖:</p>
<p><img src="/images/blog/post1/img1.png" alt=""></p>
<p>我們可以看到opencv已經幫我把所有格線都畫下來了，唯一美中不足的是，仍然會偵測到許多明明不是格線，卻還是畫線的地方，那是因為<strong>紙本文件本身不夠清晰的緣故</strong>，讓程式誤判了許多直線。</p>
<h4 id="問題一">問題一</h4>
<blockquote>
<p>因為我最後必須把每一格資料清楚地切下來，但是實在是誤判太多雜線了，若是照著這些雜線切下去，一定會出大事&hellip;&hellip;.</p>
</blockquote>
<p>於是我在原先的程式碼中新增了一段程式，用來判斷線段的斜率，來篩選出水平線與垂直線 :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>verti_lst <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>horiz_lst <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> lines:
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  將線段的四個點座標分別assign到x1,y1,x2,y2</span>
</span></span><span style="display:flex;"><span>    x1,y1,x2,y2 <span style="color:#f92672">=</span> i[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  計算斜率</span>
</span></span><span style="display:flex;"><span>    slope <span style="color:#f92672">=</span> (y2<span style="color:#f92672">-</span>y1)<span style="color:#f92672">/</span>(x2<span style="color:#f92672">-</span>x1)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  判斷斜率篩選出垂直線與水平線</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> slope <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>inf:
</span></span><span style="display:flex;"><span>        cv2<span style="color:#f92672">.</span>line(img,(x1,y1),(x2,y2),(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>),<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  將垂直線的 x1座標紀錄在verti_lst裡</span>
</span></span><span style="display:flex;"><span>        verti_lst<span style="color:#f92672">.</span>append(x1)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> slope <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        cv2<span style="color:#f92672">.</span>line(img,(x1,y1),(x2,y2),(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>),<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  將水平線的 y1座標紀錄在horiz_lst裡</span>
</span></span><span style="display:flex;"><span>        horiz_lst<span style="color:#f92672">.</span>append(y1)
</span></span></code></pre></div><p>讓我們來看看 horiz_lst 裡面的紀錄的水平線座標 :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>horiz_lst 
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">632</span>,<span style="color:#ae81ff">630</span>,<span style="color:#ae81ff">1313</span>,<span style="color:#ae81ff">824</span>,<span style="color:#ae81ff">825</span>,<span style="color:#ae81ff">601</span>,<span style="color:#ae81ff">72</span>,<span style="color:#ae81ff">315</span>,<span style="color:#ae81ff">125</span>,<span style="color:#ae81ff">1217</span>,<span style="color:#ae81ff">507</span>,<span style="color:#ae81ff">792</span>,<span style="color:#ae81ff">1121</span>,<span style="color:#ae81ff">124</span>,<span style="color:#ae81ff">1409</span>,<span style="color:#ae81ff">127</span>,<span style="color:#ae81ff">1218</span>,<span style="color:#ae81ff">793</span>,<span style="color:#ae81ff">602</span>,<span style="color:#ae81ff">823</span>,<span style="color:#ae81ff">221</span>,<span style="color:#ae81ff">1314</span>,<span style="color:#ae81ff">877</span>,<span style="color:#ae81ff">506</span>,<span style="color:#ae81ff">1069</span>,<span style="color:#ae81ff">1068</span>,<span style="color:#ae81ff">1408</span>,<span style="color:#ae81ff">1122</span>,<span style="color:#ae81ff">697</span>,<span style="color:#ae81ff">74</span>,<span style="color:#ae81ff">71</span>,<span style="color:#ae81ff">878</span>,<span style="color:#ae81ff">509</span>,<span style="color:#ae81ff">411</span>,<span style="color:#ae81ff">696</span>,<span style="color:#ae81ff">1070</span>,<span style="color:#ae81ff">972</span>,<span style="color:#ae81ff">126</span>,<span style="color:#ae81ff">412</span>,<span style="color:#ae81ff">414</span>,<span style="color:#ae81ff">223</span>,<span style="color:#ae81ff">1123</span>,<span style="color:#ae81ff">316</span>,<span style="color:#ae81ff">219</span>,<span style="color:#ae81ff">317</span>,<span style="color:#ae81ff">128</span>,<span style="color:#ae81ff">73</span>,<span style="color:#ae81ff">410</span>,<span style="color:#ae81ff">318</span>,<span style="color:#ae81ff">603</span>,<span style="color:#ae81ff">1220</span>,<span style="color:#ae81ff">604</span>,<span style="color:#ae81ff">129</span>,<span style="color:#ae81ff">974</span>,<span style="color:#ae81ff">220</span>,<span style="color:#ae81ff">973</span>,<span style="color:#ae81ff">122</span>,<span style="color:#ae81ff">75</span>,<span style="color:#ae81ff">508</span>,<span style="color:#ae81ff">1316</span>,<span style="color:#ae81ff">698</span>,<span style="color:#ae81ff">699</span>,<span style="color:#ae81ff">222</span>,<span style="color:#ae81ff">413</span>,<span style="color:#ae81ff">1411</span>,<span style="color:#ae81ff">1315</span>,<span style="color:#ae81ff">1410</span>,<span style="color:#ae81ff">319</span>,<span style="color:#ae81ff">1219</span>,<span style="color:#ae81ff">701</span>,<span style="color:#ae81ff">1124</span>,<span style="color:#ae81ff">794</span>,<span style="color:#ae81ff">98</span>,<span style="color:#ae81ff">822</span>,<span style="color:#ae81ff">827</span>,<span style="color:#ae81ff">415</span>,<span style="color:#ae81ff">826</span>,<span style="color:#ae81ff">99</span>,<span style="color:#ae81ff">1072</span>,<span style="color:#ae81ff">505</span>,<span style="color:#ae81ff">795</span>,<span style="color:#ae81ff">879</span>,<span style="color:#ae81ff">224</span>,<span style="color:#ae81ff">93</span>,<span style="color:#ae81ff">975</span>,<span style="color:#ae81ff">97</span>,<span style="color:#ae81ff">76</span>,<span style="color:#ae81ff">510</span>,<span style="color:#ae81ff">976</span>,<span style="color:#ae81ff">94</span>,<span style="color:#ae81ff">1311</span>,<span style="color:#ae81ff">526</span>,<span style="color:#ae81ff">880</span>,<span style="color:#ae81ff">92</span>,<span style="color:#ae81ff">1125</span>,<span style="color:#ae81ff">1071</span>,<span style="color:#ae81ff">605</span>,<span style="color:#ae81ff">320</span>,<span style="color:#ae81ff">95</span>,<span style="color:#ae81ff">700</span>,<span style="color:#ae81ff">123</span>,<span style="color:#ae81ff">96</span>,<span style="color:#ae81ff">113</span>,<span style="color:#ae81ff">114</span>,<span style="color:#ae81ff">88</span>,<span style="color:#ae81ff">881</span>,<span style="color:#ae81ff">112</span>,<span style="color:#ae81ff">115</span>,<span style="color:#ae81ff">606</span>,<span style="color:#ae81ff">1412</span>,<span style="color:#ae81ff">1318</span>,<span style="color:#ae81ff">89</span>,<span style="color:#ae81ff">695</span>,<span style="color:#ae81ff">796</span>,<span style="color:#ae81ff">90</span>,<span style="color:#ae81ff">1221</span>,<span style="color:#ae81ff">511</span>,<span style="color:#ae81ff">116</span>,<span style="color:#ae81ff">1222</span>,<span style="color:#ae81ff">91</span>,<span style="color:#ae81ff">525</span>,<span style="color:#ae81ff">828</span>,<span style="color:#ae81ff">702</span>,<span style="color:#ae81ff">1317</span>,<span style="color:#ae81ff">151</span>,<span style="color:#ae81ff">118</span>,<span style="color:#ae81ff">1407</span>]
</span></span></code></pre></div><p>看起來opencv並沒有按照線條的高低順序做排列，但是我們可以用sorted()來對這個list按照大小做排列:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sorted(horiz_lst)
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">71</span>,<span style="color:#ae81ff">72</span>,<span style="color:#ae81ff">73</span>,<span style="color:#ae81ff">74</span>,<span style="color:#ae81ff">75</span>,<span style="color:#ae81ff">76</span>,<span style="color:#ae81ff">88</span>,<span style="color:#ae81ff">89</span>,<span style="color:#ae81ff">90</span>,<span style="color:#ae81ff">91</span>,<span style="color:#ae81ff">92</span>,<span style="color:#ae81ff">93</span>,<span style="color:#ae81ff">94</span>,<span style="color:#ae81ff">95</span>,<span style="color:#ae81ff">96</span>,<span style="color:#ae81ff">97</span>,<span style="color:#ae81ff">98</span>,<span style="color:#ae81ff">99</span>,<span style="color:#ae81ff">112</span>,<span style="color:#ae81ff">113</span>,<span style="color:#ae81ff">114</span>,<span style="color:#ae81ff">115</span>,<span style="color:#ae81ff">116</span>,<span style="color:#ae81ff">118</span>,<span style="color:#ae81ff">122</span>,<span style="color:#ae81ff">123</span>,<span style="color:#ae81ff">124</span>,<span style="color:#ae81ff">125</span>,<span style="color:#ae81ff">126</span>,<span style="color:#ae81ff">127</span>,<span style="color:#ae81ff">128</span>,<span style="color:#ae81ff">129</span>,<span style="color:#ae81ff">151</span>,<span style="color:#ae81ff">219</span>,<span style="color:#ae81ff">220</span>,<span style="color:#ae81ff">221</span>,<span style="color:#ae81ff">222</span>,<span style="color:#ae81ff">223</span>,<span style="color:#ae81ff">224</span>,<span style="color:#ae81ff">315</span>,<span style="color:#ae81ff">316</span>,<span style="color:#ae81ff">317</span>,<span style="color:#ae81ff">318</span>,<span style="color:#ae81ff">319</span>,<span style="color:#ae81ff">320</span>,<span style="color:#ae81ff">410</span>,<span style="color:#ae81ff">411</span>,<span style="color:#ae81ff">412</span>,<span style="color:#ae81ff">413</span>,<span style="color:#ae81ff">414</span>,<span style="color:#ae81ff">415</span>,<span style="color:#ae81ff">505</span>,<span style="color:#ae81ff">506</span>,<span style="color:#ae81ff">507</span>,<span style="color:#ae81ff">508</span>,<span style="color:#ae81ff">509</span>,<span style="color:#ae81ff">510</span>,<span style="color:#ae81ff">511</span>,<span style="color:#ae81ff">525</span>,<span style="color:#ae81ff">526</span>,<span style="color:#ae81ff">601</span>,<span style="color:#ae81ff">602</span>,<span style="color:#ae81ff">603</span>,<span style="color:#ae81ff">604</span>,<span style="color:#ae81ff">605</span>,<span style="color:#ae81ff">606</span>,<span style="color:#ae81ff">630</span>,<span style="color:#ae81ff">632</span>,<span style="color:#ae81ff">695</span>,<span style="color:#ae81ff">696</span>,<span style="color:#ae81ff">697</span>,<span style="color:#ae81ff">698</span>,<span style="color:#ae81ff">699</span>,<span style="color:#ae81ff">700</span>,<span style="color:#ae81ff">701</span>,<span style="color:#ae81ff">702</span>,<span style="color:#ae81ff">792</span>,<span style="color:#ae81ff">793</span>,<span style="color:#ae81ff">794</span>,<span style="color:#ae81ff">795</span>,<span style="color:#ae81ff">796</span>,<span style="color:#ae81ff">822</span>,<span style="color:#ae81ff">823</span>,<span style="color:#ae81ff">824</span>,<span style="color:#ae81ff">825</span>,<span style="color:#ae81ff">826</span>,<span style="color:#ae81ff">827</span>,<span style="color:#ae81ff">828</span>,<span style="color:#ae81ff">877</span>,<span style="color:#ae81ff">878</span>,<span style="color:#ae81ff">879</span>,<span style="color:#ae81ff">880</span>,<span style="color:#ae81ff">881</span>,<span style="color:#ae81ff">972</span>,<span style="color:#ae81ff">973</span>,<span style="color:#ae81ff">974</span>,<span style="color:#ae81ff">975</span>,<span style="color:#ae81ff">976</span>,<span style="color:#ae81ff">1068</span>,<span style="color:#ae81ff">1069</span>,<span style="color:#ae81ff">1070</span>,<span style="color:#ae81ff">1071</span>,<span style="color:#ae81ff">1072</span>,<span style="color:#ae81ff">1121</span>,<span style="color:#ae81ff">1122</span>,<span style="color:#ae81ff">1123</span>,<span style="color:#ae81ff">1124</span>,<span style="color:#ae81ff">1125</span>,<span style="color:#ae81ff">1217</span>,<span style="color:#ae81ff">1218</span>,<span style="color:#ae81ff">1219</span>,<span style="color:#ae81ff">1220</span>,<span style="color:#ae81ff">1221</span>,<span style="color:#ae81ff">1222</span>,<span style="color:#ae81ff">1311</span>,<span style="color:#ae81ff">1313</span>,<span style="color:#ae81ff">1314</span>,<span style="color:#ae81ff">1315</span>,<span style="color:#ae81ff">1316</span>,<span style="color:#ae81ff">1317</span>,<span style="color:#ae81ff">1318</span>,<span style="color:#ae81ff">1407</span>,<span style="color:#ae81ff">1408</span>,<span style="color:#ae81ff">1409</span>,<span style="color:#ae81ff">1410</span>,<span style="color:#ae81ff">1411</span>,<span style="color:#ae81ff">1412</span>]
</span></span></code></pre></div><p>如此一來，我們已經成功按照高低順序紀錄下opencv幫我們抓下來的所有水平線y軸座標，可是我們可以發現 list 中有很多 &ldquo;連號的座標&rdquo;，我在這邊把它理解為同樣一條格線，電腦可能在上面重複畫了好幾條線，只是我們人眼認為只有一條而已。</p>
<p>同時也發現，越明顯的格線(也就是我們真正要的格線)，電腦會幫它畫上更多次，所以我寫了一個function，把剛剛的 座標list 作為輸入，最後希望輸出真正格線的y座標</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reselect_y_coordinates</span>(coordinates_lst):
</span></span><span style="display:flex;"><span>    coordinates_lst <span style="color:#f92672">=</span> sorted(coordinates_lst)
</span></span><span style="display:flex;"><span>    bag <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> coordinates_lst:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(bag) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            bag<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> i<span style="color:#f92672">-</span>bag[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>:               <span style="color:#f92672">//</span>判斷連號
</span></span><span style="display:flex;"><span>                bag<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> len(bag) <span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">5</span>:            <span style="color:#f92672">//</span>若連號的數量<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">.</span>append(bag[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])  <span style="color:#f92672">//</span>把最後一號記錄下來
</span></span><span style="display:flex;"><span>                bag<span style="color:#f92672">.</span>clear()
</span></span><span style="display:flex;"><span>                bag<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span></code></pre></div><p>結果如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>reselect_y_coordinates(sorted(horiz_lst))
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">76</span>,<span style="color:#ae81ff">99</span>,<span style="color:#ae81ff">116</span>,<span style="color:#ae81ff">129</span>,<span style="color:#ae81ff">224</span>,<span style="color:#ae81ff">320</span>,<span style="color:#ae81ff">415</span>,<span style="color:#ae81ff">511</span>,<span style="color:#ae81ff">606</span>,<span style="color:#ae81ff">702</span>,<span style="color:#ae81ff">796</span>,<span style="color:#ae81ff">828</span>,<span style="color:#ae81ff">881</span>,<span style="color:#ae81ff">976</span>,<span style="color:#ae81ff">1072</span>,<span style="color:#ae81ff">1125</span>,<span style="color:#ae81ff">1222</span>,<span style="color:#ae81ff">1318</span>]
</span></span></code></pre></div><p>例如 : 122,123,124,125,126,127,128,129中，一共畫了8條，因此判定它就是一條我們所要的水平線，所以我們取最後一號129作為待會要切割的y軸座標。</p>
<p>例如 : 151，只畫了1條線，因此判定它就是所謂的雜線，所以就把它丟掉吧 !</p>
<p>例如 : 219,220,221,222,223,224中，一共畫了6條，因此判定它也是我們要的水平線，取224作為待會要切割的y軸座標。</p>
<p>所以現在我們得到了[129,224]，這就是我要的 !</p>
<p>同理，垂直線也用一樣的方式 :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reselect_x_coordinates</span>(coordinates_lst):
</span></span><span style="display:flex;"><span>    coordinates_lst <span style="color:#f92672">=</span> sorted(coordinates_lst)
</span></span><span style="display:flex;"><span>    bag <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> coordinates_lst:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(bag) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            bag<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> i<span style="color:#f92672">-</span>bag[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                bag<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> len(bag) <span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">3</span>:
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">.</span>append(bag[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>                bag<span style="color:#f92672">.</span>clear()
</span></span><span style="display:flex;"><span>                bag<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span></code></pre></div><p>現在得到格線的x軸y軸座標後，我們可以輕易地把每一小格都切下來，方法如下 :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>img <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(image_name)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,len(horiz_lst)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,len(verti_lst)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        crop_img <span style="color:#f92672">=/</span> img[horiz_lst[i]:horiz_lst[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>],verti_lst[j]:verti_lst[j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]]
</span></span><span style="display:flex;"><span>        cv2<span style="color:#f92672">.</span>imwrite(str(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>str(j)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.png&#34;</span>)
</span></span></code></pre></div><p>如此就可以得到一小格一小格的圖片啦~</p>
<p><img src="/images/blog/post1/img2.png" alt=""></p>
<h3 id="文字辨識">文字辨識</h3>
<p>當我們得到這些圖片之後，我們可以開始使用 pytesseractx來做簡單的文字辨識，這邊幫大家做了一個簡單的function，有興趣的人可以自行輸入你想辨識的圖片，它將會幫你輸出辨識結果，程式碼如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image,ImageEnhance
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pytesseract
</span></span><span style="display:flex;"><span>pytesseract<span style="color:#f92672">.</span>pytesseract<span style="color:#f92672">.</span>tesseract_cmd <span style="color:#f92672">=</span> <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:/Program Files/Tesseract-OCR/tesseract.exe&#39;</span>
</span></span><span style="display:flex;"><span>tessdata_dir_config <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;--tessdata-dir &#34;c://Program Files (x86)//Tesseract-OCR//tessdata&#34;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># resize_num為放大倍率、b為對比度</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pic_to_word</span>(filepath,filename,resize_num,b):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        img <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(str(filepath)<span style="color:#f92672">+</span>str(filename))
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 圖片放大</span>
</span></span><span style="display:flex;"><span>        img <span style="color:#f92672">=</span> img<span style="color:#f92672">.</span>resize((im<span style="color:#f92672">.</span>width <span style="color:#f92672">*</span> int(resize_num), im<span style="color:#f92672">.</span>height <span style="color:#f92672">*</span> int(resize_num)))
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 圖片二值化</span>
</span></span><span style="display:flex;"><span>        imgry <span style="color:#f92672">=</span> img<span style="color:#f92672">.</span>convert(<span style="color:#e6db74">&#39;L&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 對比度增強</span>
</span></span><span style="display:flex;"><span>        sharpness <span style="color:#f92672">=</span> ImageEnhance<span style="color:#f92672">.</span>Contrast(imgry)
</span></span><span style="display:flex;"><span>        sharp_img <span style="color:#f92672">=</span> sharpness<span style="color:#f92672">.</span>enhance(b)
</span></span><span style="display:flex;"><span>        content <span style="color:#f92672">=</span> pytesseract<span style="color:#f92672">.</span>image_to_string(sharp_img, lang<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;chi_tra&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(str(e)))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> content
</span></span></code></pre></div><p>以我的例子來說，我想要把所有的小格子逐一辨識完之後，直接變成一個pandas的資料結構dataframe裡，方法如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>filepath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;C:/Users/Johnny/Desktop/銀行交易紀錄/豆腐/&#34;</span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">15</span>):
</span></span><span style="display:flex;"><span>    lst <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>        filename <span style="color:#f92672">=</span> str(i)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;-&#34;</span><span style="color:#f92672">+</span>str(j)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.png&#34;</span>
</span></span><span style="display:flex;"><span>        resize_num <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        lst<span style="color:#f92672">.</span>append(pic_to_word(filepath,filename,resize_num,b))
</span></span><span style="display:flex;"><span>    result<span style="color:#f92672">.</span>append(lst)
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(result)
</span></span></code></pre></div><p><img src="/images/blog/post1/img3.png" alt=""></p>
<p>這樣就簡單製作好了一個dataframe了 ，若各位對pandas的基本操作還不熟，我之後會考慮出幾個的我的實際使用pandas做專案的實作文兼教學文，再請各位多多支持 !</p>
<p>但是結果並不如預期，其實pytesseract辨識的成果已經不錯了，數字的部分我給90分，但中文字的部分我只能給59分&hellip;&hellip;.</p>
<p>我們要追求的是都要100分呀~~~~~~~~</p>
<h2 id="結語">結語</h2>
<p>我認為有以下還能改進的地方:</p>
<ol>
<li>最根本的問題，紙本文件要清楚、整潔。</li>
<li>第二重要的問題，掃描機必須夠強。</li>
<li>我切豆腐的演算法還不夠好，我希望還能更加完善。</li>
<li>若上面兩點都能有所改進的話，也許pytesseract的辨識率會大幅增加。</li>
<li>但我們仍然不放棄使用深度學習的方式來做這個project，所以之後有機會的話，我會嘗試出一篇是搭配深度學習方法的文章(等我學會)。</li>
</ol>
          </article>
        </div>
      </div>
      <div class="col-sm-12 col-md-12 col-lg-3">
        <div class="sticky-sidebar">
          
          <aside class="toc">
              <h5>
                Table Of Contents
              </h5>
              <div class="toc-content">
                <nav id="TableOfContents">
  <ul>
    <li><a href="#前言">前言</a></li>
    <li><a href="#心路歷程">心路歷程</a>
      <ul>
        <li><a href="#hough-transform">Hough Transform</a></li>
        <li><a href="#文字辨識">文字辨識</a></li>
      </ul>
    </li>
    <li><a href="#結語">結語</a></li>
  </ul>
</nav>
              </div>
          </aside>
          

          
          <aside class="tags">
            <h5>Tags</h5>
            <ul class="tags-ul list-unstyled list-inline">
              
              <li class="list-inline-item"><a href="https://between2058.github.io/tags/pandas" target="_blank">pandas</a></li>
              
              <li class="list-inline-item"><a href="https://between2058.github.io/tags/hough-transform" target="_blank">Hough Transform</a></li>
              
              <li class="list-inline-item"><a href="https://between2058.github.io/tags/big-data" target="_blank">Big Data</a></li>
              
            </ul>
          </aside>
          

          
          <aside class="social">
            <h5>Social</h5>
            <div class="social-content">
              <ul class="list-inline">
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://twitter.com/share?text=%e4%bd%bf%e7%94%a8python%e8%90%83%e5%8f%96%e6%8e%83%e6%8f%8f%e6%96%87%e4%bb%b6%e4%b8%ad%e7%9a%84%e8%a1%a8%e6%a0%bc%28%e4%b8%80%29%e5%88%87%e8%b1%86%e8%85%90%e7%af%87&url=https%3a%2f%2fbetween2058.github.io%2fblogs%2f%25E4%25BD%25BF%25E7%2594%25A8python%25E8%2590%2583%25E5%258F%2596%25E6%258E%2583%25E6%258F%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%25AD%25E7%259A%2584%25E8%25A1%25A8%25E6%25A0%25BC%25E4%25B8%2580%25E5%2588%2587%25E8%25B1%2586%25E8%2585%2590%25E7%25AF%2587%2f">
                    <i class="fab fa-twitter"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://api.whatsapp.com/send?text=%e4%bd%bf%e7%94%a8python%e8%90%83%e5%8f%96%e6%8e%83%e6%8f%8f%e6%96%87%e4%bb%b6%e4%b8%ad%e7%9a%84%e8%a1%a8%e6%a0%bc%28%e4%b8%80%29%e5%88%87%e8%b1%86%e8%85%90%e7%af%87: https%3a%2f%2fbetween2058.github.io%2fblogs%2f%25E4%25BD%25BF%25E7%2594%25A8python%25E8%2590%2583%25E5%258F%2596%25E6%258E%2583%25E6%258F%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%25AD%25E7%259A%2584%25E8%25A1%25A8%25E6%25A0%25BC%25E4%25B8%2580%25E5%2588%2587%25E8%25B1%2586%25E8%2585%2590%25E7%25AF%2587%2f">
                    <i class="fab fa-whatsapp"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href="mailto:?subject=%e4%bd%bf%e7%94%a8python%e8%90%83%e5%8f%96%e6%8e%83%e6%8f%8f%e6%96%87%e4%bb%b6%e4%b8%ad%e7%9a%84%e8%a1%a8%e6%a0%bc%28%e4%b8%80%29%e5%88%87%e8%b1%86%e8%85%90%e7%af%87&amp;body=Check out this site https%3a%2f%2fbetween2058.github.io%2fblogs%2f%25E4%25BD%25BF%25E7%2594%25A8python%25E8%2590%2583%25E5%258F%2596%25E6%258E%2583%25E6%258F%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%25AD%25E7%259A%2584%25E8%25A1%25A8%25E6%25A0%25BC%25E4%25B8%2580%25E5%2588%2587%25E8%25B1%2586%25E8%2585%2590%25E7%25AF%2587%2f">
                    <i class="fa fa-envelope"></i>
                  </a>
                </li>
              </ul>
            </div>
          </aside>
          
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12 col-lg-9 p-2">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "gurusabarish" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    </div>
  </div>
  <button class="p-2 px-3" onclick="topFunction()" id="topScroll">
    <i class="fas fa-angle-up"></i>
  </button>
</section>

<script>
  var topScroll = document.getElementById("topScroll");
  window.onscroll = function() {scrollFunction()};

  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      topScroll.style.display = "block";
    } else {
      topScroll.style.display = "none";
    }
  }

  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }
</script>


  </div><footer>
    <div class="container py-3" id="recent-posts">
    
    <div class="h3 text-center text-secondary py-3">Recent posts</div>
    <div class="row justify-content-center">
        
        <div class="col-lg-4 col-md-6 pt-2">
            <div class="card h-100">
                <div class="card-body bg-transparent p-3 shadow-sm">
                    <a href="/blogs/pandas%E5%88%86%E6%9E%90pdf%E6%96%87%E6%9C%AC%E8%AD%89%E4%BA%A4%E6%89%80%E8%82%A1%E7%A5%A8%E4%BA%A4%E6%98%93%E7%B4%80%E9%8C%84%E8%B3%87%E6%96%99%E5%89%8D%E8%99%95%E7%90%86%E7%AF%87/" class="primary-font card-title">
                        <h5 class="card-title bg-transparent" title="pandas分析PDF文本證交所股票交易紀錄(資料前處理篇)">pandas分析PDF文本證交所股票交易紀錄(資料 …</h5>
                    </a>
                    <div class="card-text secondary-font">
                        <p><blockquote>
<p>在這個漸漸邁向大數據的時代裡，資料將會成為最珍貴的寶物，為了要快速用程式分析這些大數據，我們不但要將未來的各種事物直接導向數位化，更要學習如何把過去的傳統紙本資料轉化為數位格式。</p>
</blockquote></p>
                    </div>
                </div>
                <div class="mt-auto card-footer">
                    <span class="float-start">February 27, 2020</span>
                    <a href="/blogs/pandas%E5%88%86%E6%9E%90pdf%E6%96%87%E6%9C%AC%E8%AD%89%E4%BA%A4%E6%89%80%E8%82%A1%E7%A5%A8%E4%BA%A4%E6%98%93%E7%B4%80%E9%8C%84%E8%B3%87%E6%96%99%E5%89%8D%E8%99%95%E7%90%86%E7%AF%87/" class="float-end btn btn-outline-info btn-sm">Read</a>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 col-md-6 pt-2">
            <div class="card h-100">
                <div class="card-body bg-transparent p-3 shadow-sm">
                    <a href="/blogs/%E4%BD%BF%E7%94%A8python%E8%90%83%E5%8F%96%E6%8E%83%E6%8F%8F%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E8%A1%A8%E6%A0%BC%E4%B8%80%E5%88%87%E8%B1%86%E8%85%90%E7%AF%87/" class="primary-font card-title">
                        <h5 class="card-title bg-transparent" title="使用python萃取掃描文件中的表格(一)切豆腐篇">使用python萃取掃描文件中的表格(一)切豆腐篇</h5>
                    </a>
                    <div class="card-text secondary-font">
                        <p><blockquote>
<p>在這個漸漸邁向大數據的時代裡，資料將會成為最珍貴的寶物，為了要快速用程式分析這些大數據，我們不但要將未來的各種事物直接導向數位化，更要學習如何把過去的傳統紙本資料轉化為數位格式。</p>
</blockquote></p>
                    </div>
                </div>
                <div class="mt-auto card-footer">
                    <span class="float-start">February 21, 2020</span>
                    <a href="/blogs/%E4%BD%BF%E7%94%A8python%E8%90%83%E5%8F%96%E6%8E%83%E6%8F%8F%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E8%A1%A8%E6%A0%BC%E4%B8%80%E5%88%87%E8%B1%86%E8%85%90%E7%AF%87/" class="float-end btn btn-outline-info btn-sm">Read</a>
                </div>
            </div>
        </div>
        
    </div>
    
</div><div class="text-center pt-2">
    
    <span class="px-1">
        <a href="https://github.com/between2058" aria-label="github">
            <svg xmlns="http://www.w3.org/2000/svg" width="2.7em" height="2.7em" viewBox="0 0 1792 1792">
                <path
                    d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5t-203.5 84.5h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-86-13.5q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5h-224q-119 0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5 84.5t84.5 203.5z" />

                <metadata>
                    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                        xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:dc="http://purl.org/dc/elements/1.1/">
                        <rdf:Description about="https://iconscout.com/legal#licenses"
                            dc:title="Github, Online, Project, Hosting, Square"
                            dc:description="Github, Online, Project, Hosting, Square" dc:publisher="Iconscout"
                            dc:date="2016-12-14" dc:format="image/svg+xml" dc:language="en">
                            <dc:creator>
                                <rdf:Bag>
                                    <rdf:li>Font Awesome</rdf:li>
                                </rdf:Bag>
                            </dc:creator>
                        </rdf:Description>
                    </rdf:RDF>
                </metadata>
            </svg>
        </a>
    </span>
    

    
    <span class="px-1">
        <a href="https://www.linkedin.com/in/%E8%88%9C%E7%A8%8B-%E5%BC%B5-629524186/" aria-label="linkedin">
            <svg xmlns="http://www.w3.org/2000/svg" width='2.4em' height='2.4em' fill="#fff" aria-label="LinkedIn"
                viewBox="0 0 512 512">
                <rect width="512" height="512" fill="#0077b5" rx="15%" />
                <circle cx="142" cy="138" r="37" />
                <path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198" />
                <path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32" />
            </svg>
        </a>
    </span>
    

    

    
    <a href="https://www.instagram.com/between2058/" aria-label="instagram">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48px" height="48px">
            <radialGradient id="yOrnnhliCrdS2gy~4tD8ma" cx="19.38" cy="42.035" r="44.899"
                gradientUnits="userSpaceOnUse">
                <stop offset="0" stop-color="#fd5" />
                <stop offset=".328" stop-color="#ff543f" />
                <stop offset=".348" stop-color="#fc5245" />
                <stop offset=".504" stop-color="#e64771" />
                <stop offset=".643" stop-color="#d53e91" />
                <stop offset=".761" stop-color="#cc39a4" />
                <stop offset=".841" stop-color="#c837ab" />
            </radialGradient>
            <path fill="url(#yOrnnhliCrdS2gy~4tD8ma)"
                d="M34.017,41.99l-20,0.019c-4.4,0.004-8.003-3.592-8.008-7.992l-0.019-20	c-0.004-4.4,3.592-8.003,7.992-8.008l20-0.019c4.4-0.004,8.003,3.592,8.008,7.992l0.019,20	C42.014,38.383,38.417,41.986,34.017,41.99z" />
            <radialGradient id="yOrnnhliCrdS2gy~4tD8mb" cx="11.786" cy="5.54" r="29.813"
                gradientTransform="matrix(1 0 0 .6663 0 1.849)" gradientUnits="userSpaceOnUse">
                <stop offset="0" stop-color="#4168c9" />
                <stop offset=".999" stop-color="#4168c9" stop-opacity="0" />
            </radialGradient>
            <path fill="url(#yOrnnhliCrdS2gy~4tD8mb)"
                d="M34.017,41.99l-20,0.019c-4.4,0.004-8.003-3.592-8.008-7.992l-0.019-20	c-0.004-4.4,3.592-8.003,7.992-8.008l20-0.019c4.4-0.004,8.003,3.592,8.008,7.992l0.019,20	C42.014,38.383,38.417,41.986,34.017,41.99z" />
            <path fill="#fff"
                d="M24,31c-3.859,0-7-3.14-7-7s3.141-7,7-7s7,3.14,7,7S27.859,31,24,31z M24,19c-2.757,0-5,2.243-5,5	s2.243,5,5,5s5-2.243,5-5S26.757,19,24,19z" />
            <circle cx="31.5" cy="16.5" r="1.5" fill="#fff" />
            <path fill="#fff"
                d="M30,37H18c-3.859,0-7-3.14-7-7V18c0-3.86,3.141-7,7-7h12c3.859,0,7,3.14,7,7v12	C37,33.86,33.859,37,30,37z M18,13c-2.757,0-5,2.243-5,5v12c0,2.757,2.243,5,5,5h12c2.757,0,5-2.243,5-5V18c0-2.757-2.243-5-5-5H18z" />
        </svg>
    </a>
    

    
</div><div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-4 text-center">
            <div class="pb-2">
                <a href="https://between2058.github.io" title="Johnny&#39;s blog">
                    <img alt="Footer logo" src="/fav.png"
                        height="40px" width="40px">
                </a>
            </div>
            &copy; 2022  All Rights Reserved
            <div class="text-secondary">
                Made with
                <span class="text-danger">
                    &#10084;
                </span>
                and Johnny Chang
            </div>
        </div>
    </div>
</div></footer>
<script>
    if (document.body.className.includes("light")) {
        document.body.classList.add('dark');
        localStorage.setItem("pref-theme", 'dark');
    }
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })

</script>

<script>
    let loadingIcons;

    function loading() {
        myVar = setTimeout(showPage, 100);
    }

    function showPage() {
        try{
            document.getElementById("loading-icons").style.display = "block";
        } catch(err) {}
    }
</script></body>

</html>